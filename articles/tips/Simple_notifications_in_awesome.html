

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Simple notifications in awesome &mdash; JNRowe</title>
    
    <link rel="stylesheet" href="../../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/icon.ico"/>
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="top" title="JNRowe" href="../../index.html" />
    <link rel="up" title="Tips" href="index.html" />
    <link rel="next" title="Theming mutt" href="Theming_mutt.html" />
    <link rel="prev" title="Sharing Xresources between systems" href="Sharing_Xresources_between_systems.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../../index.html">
            <img class="logo" src="../../_static/logo.png" alt="Logo"/>
          </a></p>
        <div class="headertitle"><a
          href="../../index.html">JNRowe</a></div>
        <div class="rel">
          <a href="Sharing_Xresources_between_systems.html" title="Sharing Xresources between systems"
             accesskey="P">previous</a> |
          <a href="Theming_mutt.html" title="Theming mutt"
             accesskey="N">next</a> |
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="simple-notifications-in-awesome">
<h1>Simple notifications in awesome<a class="headerlink" href="#simple-notifications-in-awesome" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">date:</th><td class="field-body">2009-10-04</td>
</tr>
</tbody>
</table>
<p>On seeing my window notifications in <a class="reference external" href="http://awesome.naquadah.org/">awesome</a> from a screencast for a new
project at work Matt Cooper asks:</p>
<blockquote>
<div>Is there a library that does those fancy notifications or do you have to
hack it up yourself?</div></blockquote>
<img alt="notifications in awesome" class="align-right" src="../../_images/2009-10-04-awesome_notifications.png" />
<p>There is a library to make notification popups in awesome, and it is called
<a class="reference external" href="http://awesome.naquadah.org/doc/api/modules/naughty.html">naughty</a>.  With it notifications are as simple as calling <tt class="docutils literal"><span class="pre">naughty.notify</span></tt>,
for example:</p>
<div class="highlight-lua"><div class="highlight"><pre><span class="nb">require</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">naughty&quot;</span><span class="p">)</span>

<span class="n">naughty</span><span class="p">.</span><span class="n">notify</span><span class="p">({</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">my little popup&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">bottom_left&quot;</span> <span class="p">})</span>
</pre></div>
</div>
<p><a class="reference external" href="http://gist.github.com/201130">Fork this code</a></p>
<p>I do however define a few functions in my configuration file to simplify the
normal notifications I use:</p>
<div class="highlight-lua"><div class="highlight"><pre><span class="c1">-- Generic info/warn/error notifications</span>
<span class="n">notify</span> <span class="o">=</span> <span class="p">{}</span>

<span class="kd">local</span> <span class="n">debug_messages</span> <span class="o">=</span> <span class="kc">false</span>
<span class="c1">-- debug_notify: Display notification when debug_messages is true</span>
<span class="k">function</span> <span class="nc">notify</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">debug_messages</span> <span class="k">then</span>
        <span class="n">naughty</span><span class="p">.</span><span class="n">notify</span><span class="p">({</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">&lt;span color=&#39;#ff00ff&#39;&gt;Debug&lt;/span&gt;:&quot;</span> <span class="o">..</span> <span class="n">awful</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">escape</span><span class="p">(</span><span class="n">text</span><span class="p">),</span>
                        <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">350</span> <span class="p">})</span>
    <span class="k">end</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nc">notify</span><span class="p">.</span><span class="nf">_gnotify</span><span class="p">(</span><span class="n">ntype</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">colour</span> <span class="o">=</span> <span class="n">beautiful</span><span class="p">.</span><span class="n">fg_normal</span>
    <span class="k">if</span> <span class="n">ntype</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="s">info&quot;</span> <span class="k">then</span>
        <span class="n">colour</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">#00ff00&quot;</span>
    <span class="k">elseif</span> <span class="n">ntype</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="s">warn&quot;</span> <span class="k">then</span>
        <span class="n">colour</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">#ffff00&quot;</span>
    <span class="k">elseif</span> <span class="n">ntype</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="s">error&quot;</span> <span class="k">then</span>
        <span class="n">colour</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">#ff0000&quot;</span>
    <span class="k">end</span>
    <span class="n">naughty</span><span class="p">.</span><span class="n">notify</span><span class="p">({</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">&lt;span color=&#39;&quot;</span> <span class="o">..</span> <span class="n">colour</span> <span class="o">..</span> <span class="s2">&quot;</span><span class="s">&#39;&gt;●&lt;/span&gt; &quot;</span> <span class="o">..</span>
                        <span class="n">awful</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">escape</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="p">})</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nc">notify</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">notify</span><span class="p">.</span><span class="n">_gnotify</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">info&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="k">end</span>
<span class="k">function</span> <span class="nc">notify</span><span class="p">.</span><span class="nf">stop</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">notify</span><span class="p">.</span><span class="n">_gnotify</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">error&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="k">end</span>
<span class="k">function</span> <span class="nc">notify</span><span class="p">.</span><span class="nf">warn</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">notify</span><span class="p">.</span><span class="n">_gnotify</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">warn&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p><a class="reference external" href="http://gist.github.com/201131">Fork this code</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you&#8217;re willing to install <a class="reference external" href="http://github.com/samsarin/lua-functional">lua-functional</a>, the above code snippet can be
made much nicer by using its <tt class="docutils literal"><span class="pre">partial</span></tt> application support to define
<tt class="docutils literal"><span class="pre">start</span></tt> and <tt class="docutils literal"><span class="pre">stop</span></tt>.</p>
</div>
<p>This group of functions, all namespaced under <tt class="docutils literal"><span class="pre">notify</span></tt>, provide simple wrappers
for the everyday notifications I use.  <tt class="docutils literal"><span class="pre">notify.debug</span></tt> is a nice way to be able
to litter your configuration file with visible pointers as to what is going on,
set <tt class="docutils literal"><span class="pre">debug_messages</span> <span class="pre">=</span> <span class="pre">true</span></tt> in your <tt class="docutils literal"><span class="pre">rc.lua</span></tt> to enable all the debug information
and switch it back to <tt class="docutils literal"><span class="pre">false</span></tt> to stop it being displayed.</p>
<p>The <tt class="docutils literal"><span class="pre">notify.{start,stop,warn}</span></tt> functions prepend the text you pass it with
a coloured Unicode bullet.  awesome makes use of <a class="reference external" href="http://www.pango.org/">pango</a>
meaning you can easily use pretty much any character you wish, or more
specifically any character your font can display.  From time to time I&#8217;ve
experimented with using <tt class="docutils literal"><span class="pre">Ҏ</span></tt> and <tt class="docutils literal"><span class="pre">✘</span></tt>, but most of the fonts I prefer to use don&#8217;t
display them correctly(if you&#8217;re seeing two boxes your fonts don&#8217;t either).</p>
</div>
<div class="section" id="window-creation-notifications">
<h1>Window creation notifications<a class="headerlink" href="#window-creation-notifications" title="Permalink to this headline">¶</a></h1>
<p>One of the notifications I like to have is for when new windows are opened, this
way I don&#8217;t miss windows opening on tags I&#8217;m not currently viewing.</p>
<div class="highlight-lua"><div class="highlight"><pre><span class="n">awful</span><span class="p">.</span><span class="n">hooks</span><span class="p">.</span><span class="n">manage</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">startup</span><span class="p">)</span>
    <span class="c1">-- Display the window&#39;s name, or just Application if it isn&#39;t set</span>
    <span class="n">notify</span><span class="p">.</span><span class="n">start</span><span class="p">((</span><span class="n">c</span><span class="p">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;</span><span class="s">Application&quot;</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot;</span><span class="s"> started&quot;</span><span class="p">)</span>
<span class="k">end</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="http://gist.github.com/201132">Fork this code</a></p>
</div>
<div class="section" id="network-notifications">
<h1>Network notifications<a class="headerlink" href="#network-notifications" title="Permalink to this headline">¶</a></h1>
<p>I also have the following <a class="reference external" href="http://awesome.naquadah.org/doc/api/modules/awful.hooks.html">awful</a> hook set to toggle my network monitor between
<tt class="docutils literal"><span class="pre">lo</span></tt> and <tt class="docutils literal"><span class="pre">ppp0</span></tt> depending on whether my remote network interface is up.
Having the little popups to show when the network has gone down or come up is
quite nice, and definitely more noticeable than just changing the text in the
<a class="reference external" href="http://awesome.naquadah.org/doc/api/modules/wibox.html">wibox</a>.  The code below changes the interface name in the <tt class="docutils literal"><span class="pre">wibox</span></tt>, and
switches the network graph widget to use the appropriate input too.</p>
<div class="highlight-lua"><div class="highlight"><pre><span class="n">awful</span><span class="p">.</span><span class="n">hooks</span><span class="p">.</span><span class="n">timer</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span>
    <span class="k">if</span> <span class="n">netiface</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="s">lo&quot;</span> <span class="ow">and</span> <span class="nb">io.open</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">/var/lock/LCK..ttyUSB0&quot;</span><span class="p">)</span> <span class="k">then</span>
        <span class="n">netiface</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">ppp0&quot;</span>
        <span class="n">nettext_widget</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s"> ppp0:&quot;</span>
        <span class="n">wicked</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">netbar_widget</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="s">${ppp0 up_b}&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">upload&quot;</span><span class="p">)</span>
        <span class="n">wicked</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">netbar_widget</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="s">${ppp0 down_b}&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">download&quot;</span><span class="p">)</span>
        <span class="n">notify</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">PPP0 interface has come up&quot;</span><span class="p">)</span>
    <span class="k">elseif</span> <span class="n">netiface</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="s">ppp0&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">io.open</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">/var/lock/LCK..ttyUSB0&quot;</span><span class="p">)</span> <span class="k">then</span>
        <span class="n">netiface</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">lo&quot;</span>
        <span class="n">nettext_widget</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s"> lo:&quot;</span>
        <span class="n">wicked</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">netbar_widget</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="s">${lo up_b}&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">upload&quot;</span><span class="p">)</span>
        <span class="n">wicked</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">netbar_widget</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="s">${lo down_b}&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">download&quot;</span><span class="p">)</span>
        <span class="n">notify</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">PPP0 interface has gone down&quot;</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="http://gist.github.com/201133">Fork this code</a></p>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../../projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Articles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../colophon.html">Colophon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../consult.html">Consulting services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright information</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="../../search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="Sharing_Xresources_between_systems.html" title="Sharing Xresources between systems"
             >previous</a> |
          <a href="Theming_mutt.html" title="Theming mutt"
             >next</a> |
          <a href="../../genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="../../_sources/articles/tips/Simple_notifications_in_awesome.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; <a href="../../copyright.html">Copyright</a> 2009-2013, James Rowe.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>